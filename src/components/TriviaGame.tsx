import React, { useState, useEffect, useRef } from 'react';
import { motion } from 'motion/react';
import { Users, Play, Clock, CheckCircle2, XCircle, Trophy, ArrowRight, Settings, ArrowLeft, Dices, GripHorizontal, EyeOff } from 'lucide-react';
import { TwitchChat } from './TwitchChat';

interface ChatMessage {
  id: string;
  username: string;
  message: string;
  timestamp: number;
}

interface TriviaGameProps {
  messages: ChatMessage[];
  onLeave: () => void;
  channelName: string;
  isConnected: boolean;
  error: string | null;
}

type GamePhase = 'config' | 'joining' | 'playing' | 'round_results' | 'final_results';

interface Player {
  username: string;
  score: number;
  currentAnswer?: string;
  answerTime?: number;
  roundPoints?: number;
}

interface QuestionData {
  q: string;
  a: string;
  options: string[];
}

const ARABIC_QUESTIONS = [
  { q: "كم عدد سور القرآن الكريم؟", a: "114", options: ["110", "112", "114", "120"] },
  { q: "ما هي أطول سورة في القرآن الكريم؟", a: "البقرة", options: ["آل عمران", "النساء", "البقرة", "الكهف"] },
  { q: "من هو أول الخلفاء الراشدين؟", a: "أبو بكر", options: ["عمر بن الخطاب", "علي بن أبي طالب", "عثمان بن عفان", "أبو بكر"] },
  { q: "في أي شهر يصوم المسلمون؟", a: "رمضان", options: ["شعبان", "رجب", "رمضان", "شوال"] },
  { q: "ما هو أسرع حيوان بري في العالم؟", a: "الفهد", options: ["الأسد", "النمر", "الفهد", "الغزال"] },
  { q: "ما هو الغاز الذي نتنفسه لنعيش؟", a: "الأكسجين", options: ["النيتروجين", "الهيدروجين", "الأكسجين", "ثاني أكسيد الكربون"] },
  { q: "كم عدد حواس الإنسان؟", a: "5", options: ["4", "5", "6", "7"] },
  { q: "ما هو الحيوان الذي يسمى سفينة الصحراء؟", a: "الجمل", options: ["الحصان", "الجمل", "الفيل", "النعامة"] },
  { q: "ما هي الشركة المصنعة لسيارة موستانج؟", a: "فورد", options: ["شيفروليه", "دودج", "فورد", "تويوتا"] },
  { q: "أي دولة تصنع سيارات فيراري؟", a: "إيطاليا", options: ["ألمانيا", "فرنسا", "إيطاليا", "إسبانيا"] },
  { q: "ما هي الشركة التي تنتج سيارة كامري؟", a: "تويوتا", options: ["هوندا", "نيسان", "تويوتا", "مازدا"] },
  { q: "ما هو الكوكب الأحمر؟", a: "المريخ", options: ["الزهرة", "المشتري", "المريخ", "زحل"] },
  { q: "ما هو أكبر كوكب في المجموعة الشمسية؟", a: "المشتري", options: ["زحل", "المشتري", "أورانوس", "نبتون"] },
  { q: "ما هو أقرب كوكب للشمس؟", a: "عطارد", options: ["الزهرة", "المريخ", "عطارد", "الأرض"] },
  { q: "ما هو الكوكب الذي نعيش عليه؟", a: "الأرض", options: ["المريخ", "الزهرة", "الأرض", "المشتري"] },
  { q: "ما هي عاصمة اليابان؟", a: "طوكيو", options: ["بكين", "سيول", "طوكيو", "بانكوك"] },
  { q: "ما هو أطول نهر في العالم؟", a: "النيل", options: ["الأمازون", "المسيسيبي", "النيل", "الفرات"] },
  { q: "في أي قارة تقع دولة البرازيل؟", a: "أمريكا الجنوبية", options: ["أفريقيا", "أمريكا الشمالية", "أمريكا الجنوبية", "أوروبا"] },
  { q: "ما هي عاصمة مصر؟", a: "القاهرة", options: ["الإسكندرية", "دمشق", "القاهرة", "بغداد"] },
  { q: "ما هي أصغر دولة في العالم؟", a: "الفاتيكان", options: ["موناكو", "سان مارينو", "الفاتيكان", "ليختنشتاين"] },
  { q: "ما هو لون الدم النقي؟", a: "أحمر", options: ["أزرق", "أخضر", "أحمر", "أصفر"] },
  { q: "كم عدد قارات العالم؟", a: "7", options: ["5", "6", "7", "8"] },
  { q: "ما هو حيوان الأكبر في العالم؟", a: "الحوت الأزرق", options: ["الفيل", "القرش الأبيض", "الحوت الأزرق", "الزرافة"] },
  { q: "ما هي لغة القرآن الكريم؟", a: "العربية", options: ["الإنجليزية", "الفارسية", "الأردية", "العربية"] },
  { q: "ما هو المعدن السائل في درجة حرارة الغرفة؟", a: "الزئبق", options: ["الحديد", "النحاس", "الزئبق", "الذهب"] },
  { q: "ما هي عاصمة المملكة العربية السعودية؟", a: "الرياض", options: ["جدة", "مكة المكرمة", "الرياض", "الدمام"] },
  { q: "من هو مكتشف الجاذبية؟", a: "إسحاق نيوتن", options: ["ألبرت أينشتاين", "إسحاق نيوتن", "جاليليو", "تسلا"] },
  { q: "ما هو العضو المسؤول عن ضخ الدم في الجسم؟", a: "القلب", options: ["الرئة", "الكبد", "القلب", "المعدة"] },
  { q: "كم عدد ألوان قوس قزح؟", a: "7", options: ["5", "6", "7", "8"] },
  { q: "ما هو أكبر محيط في العالم؟", a: "المحيط الهادئ", options: ["المحيط الأطلسي", "المحيط الهندي", "المحيط الهادئ", "المحيط المتجمد الشمالي"] },
  { q: "ما هي عاصمة فرنسا؟", a: "باريس", options: ["لندن", "برلين", "باريس", "مدريد"] },
  { q: "من هو مخترع المصباح الكهربائي؟", a: "توماس إديسون", options: ["نيكولا تسلا", "توماس إديسون", "ألكسندر جراهام بيل", "بنيامين فرانكلين"] },
  { q: "ما هو أثقل حيوان بري؟", a: "الفيل الأفريقي", options: ["وحيد القرن", "فرس النهر", "الفيل الأفريقي", "الزرافة"] },
  { q: "ما هو الرمز الكيميائي للماء؟", a: "H2O", options: ["CO2", "H2O", "O2", "NaCl"] },
  { q: "كم عدد أسنان الإنسان البالغ؟", a: "32", options: ["28", "30", "32", "34"] },
  { q: "ما هي عاصمة الكويت؟", a: "مدينة الكويت", options: ["الجهراء", "الفروانية", "مدينة الكويت", "حولي"] },
  { q: "من هو صاحب لقب 'سيف الله المسلول'؟", a: "خالد بن الوليد", options: ["عمر بن الخطاب", "علي بن أبي طالب", "خالد بن الوليد", "حمزة بن عبد المطلب"] },
  { q: "ما هو العلم الذي يدرس النجوم والكواكب؟", a: "علم الفلك", options: ["علم الجيولوجيا", "علم الفلك", "علم الأحياء", "علم الكيمياء"] },
  { q: "ما هي أكبر صحراء في العالم؟", a: "الصحراء الكبرى", options: ["صحراء جوبي", "الصحراء الكبرى", "صحراء الربع الخالي", "صحراء نجد"] },
  { q: "كم عدد أيام السنة الكبيسة؟", a: "366", options: ["364", "365", "366", "367"] },
  { q: "ما هو الطائر الذي لا يطير؟", a: "النعامة", options: ["الصقر", "النعامة", "البومة", "الحمام"] },
  { q: "ما هي عاصمة الإمارات العربية المتحدة؟", a: "أبوظبي", options: ["دبي", "الشارقة", "أبوظبي", "عجمان"] },
  { q: "من هو مؤلف كتاب 'القانون في الطب'؟", a: "ابن سينا", options: ["الرازي", "ابن سينا", "ابن رشد", "الفارابي"] },
  { q: "ما هو أصلب مادة طبيعية؟", a: "الألماس", options: ["الذهب", "الحديد", "الألماس", "الفولاذ"] },
  { q: "كم عدد لاعبي فريق كرة القدم؟", a: "11", options: ["9", "10", "11", "12"] },
  { q: "ما هي عاصمة الأردن؟", a: "عمان", options: ["الزرقاء", "إربد", "عمان", "العقبة"] },
  { q: "ما هو الحيوان الذي ينام وعيناه مفتوحتان؟", a: "الدلفين", options: ["السمك", "الدلفين", "الثعبان", "الأسد"] },
  { q: "ما هو الغاز الذي يستخدم في إطفاء الحرائق؟", a: "ثاني أكسيد الكربون", options: ["الأكسجين", "النيتروجين", "ثاني أكسيد الكربون", "الهيدروجين"] },
  { q: "كم عدد أضلاع المثلث؟", a: "3", options: ["3", "4", "5", "6"] },
  { q: "ما هي عاصمة قطر؟", a: "الدوحة", options: ["الوكرة", "الخور", "الدوحة", "الريان"] },
  { q: "من هو مكتشف قارة أمريكا؟", a: "كريستوفر كولومبوس", options: ["فاسكو دي جاما", "كريستوفر كولومبوس", "ماجلان", "ماركو بولو"] },
  { q: "ما هي أكبر جزيرة في العالم؟", a: "جرينلاند", options: ["مدغشقر", "جرينلاند", "أستراليا", "سومطرة"] },
  { q: "كم عدد فقرات العمود الفقري للإنسان؟", a: "33", options: ["30", "32", "33", "35"] },
  { q: "ما هو الكوكب الذي يلقب بـ 'توأم الأرض'؟", a: "الزهرة", options: ["المريخ", "الزهرة", "المشتري", "عطارد"] },
  { q: "ما هي عاصمة البحرين؟", a: "المنامة", options: ["المحرق", "الرفاع", "المنامة", "مدينة حمد"] },
  { q: "من هو مخترع الهاتف؟", a: "ألكسندر جراهام بيل", options: ["توماس إديسون", "ألكسندر جراهام بيل", "نيكولا تسلا", "ماركوني"] },
  { q: "ما هو أطول بناء في العالم؟", a: "برج خليفة", options: ["برج إيفل", "برج خليفة", "ساعة مكة", "برج شانغهاي"] },
  { q: "كم عدد شهور السنة الهجرية؟", a: "12", options: ["10", "11", "12", "13"] },
  { q: "ما هو الحيوان الذي يغير لونه؟", a: "الحرباء", options: ["الأخطبوط", "الحرباء", "الضفدع", "الثعبان"] },
  { q: "ما هي عاصمة عمان؟", a: "مسقط", options: ["صلالة", "صحار", "مسقط", "نزوى"] },
  { q: "من هو أول إنسان صعد إلى القمر؟", a: "نيل أرمسترونج", options: ["يوري جاجارين", "نيل أرمسترونج", "بز ألدرين", "مايكل كولينز"] },
  { q: "ما هو الفيتامين الذي نحصل عليه من الشمس؟", a: "فيتامين د", options: ["فيتامين أ", "فيتامين ب", "فيتامين ج", "فيتامين د"] },
  { q: "كم عدد صمامات القلب؟", a: "4", options: ["2", "3", "4", "5"] },
  { q: "ما هي عاصمة العراق؟", a: "بغداد", options: ["البصرة", "الموصل", "بغداد", "أربيل"] },
  { q: "ما هو أصغر كوكب في المجموعة الشمسية؟", a: "عطارد", options: ["المريخ", "عطارد", "نبتون", "الزهرة"] },
  { q: "من هو مؤلف رواية 'البؤساء'؟", a: "فيكتور هوجو", options: ["تشارلز ديكنز", "فيكتور هوجو", "ليون تولستوي", "شكسبير"] },
  { q: "ما هو العلم الذي يدرس الزلازل؟", a: "علم الزلازل", options: ["علم البراكين", "علم الزلازل", "علم الطقس", "علم المحيطات"] },
  { q: "كم عدد أرجل العنكبوت؟", a: "8", options: ["6", "8", "10", "12"] },
  { q: "ما هي عاصمة سوريا؟", a: "دمشق", options: ["حلب", "حمص", "دمشق", "اللاذقية"] },
  { q: "من هو مخترع الطائرة؟", a: "الأخوان رايت", options: ["ليوناردو دا فينشي", "الأخوان رايت", "هنري فورد", "جراهام بيل"] },
  { q: "ما هو أكبر خليج في العالم؟", a: "خليج المكسيك", options: ["الخليج العربي", "خليج المكسيك", "خليج البنغال", "خليج غينيا"] },
  { q: "كم عدد كواكب المجموعة الشمسية؟", a: "8", options: ["7", "8", "9", "10"] },
  { q: "ما هو الحيوان الذي يلقب بـ 'ملك الغابة'؟", a: "الأسد", options: ["النمر", "الفهد", "الأسد", "الفيل"] },
  { q: "ما هي عاصمة لبنان؟", a: "بيروت", options: ["طرابلس", "صيدا", "بيروت", "صور"] },
  { q: "من هو أول من رسم خريطة العالم؟", a: "الإدريسي", options: ["ابن بطوطة", "الإدريسي", "كولومبوس", "ماجلان"] },
  { q: "ما هو الغاز الذي يسبب الاحتباس الحراري؟", a: "ثاني أكسيد الكربون", options: ["الأكسجين", "النيتروجين", "ثاني أكسيد الكربون", "الميثان"] },
  { q: "كم عدد أوتار العود؟", a: "11", options: ["10", "11", "12", "13"] },
  { q: "ما هي عاصمة السودان؟", a: "الخرطوم", options: ["أم درمان", "الخرطوم", "بورتسودان", "كسلا"] },
  { q: "من هو مخترع الراديو؟", a: "ماركوني", options: ["تسلا", "إديسون", "ماركوني", "بيل"] },
  { q: "ما هو أعمق محيط في العالم؟", a: "المحيط الهادئ", options: ["المحيط الأطلسي", "المحيط الهندي", "المحيط الهادئ", "المحيط المتجمد الجنوبي"] },
  { q: "كم عدد حروف اللغة العربية؟", a: "28", options: ["26", "27", "28", "29"] },
  { q: "ما هو الحيوان الذي لا يشرب الماء؟", a: "جرذ الكنغر", options: ["الجمل", "جرذ الكنغر", "الثعبان", "العقرب"] },
  { q: "ما هي عاصمة المغرب؟", a: "الرباط", options: ["الدار البيضاء", "مراكش", "الرباط", "طنجة"] },
  { q: "من هو مكتشف الدورة الدموية الكبرى؟", a: "ويليام هارفي", options: ["ابن النفيس", "ويليام هارفي", "باستور", "كوك"] },
  { q: "ما هو المعدن الذي يصدأ؟", a: "الحديد", options: ["النحاس", "الألمنيوم", "الحديد", "الذهب"] },
  { q: "كم عدد لاعبي فريق كرة السلة؟", a: "5", options: ["5", "6", "7", "8"] },
  { q: "ما هي عاصمة تونس؟", a: "تونس", options: ["صفاقس", "سوسة", "تونس", "بنزرت"] },
  { q: "من هو مخترع السينما؟", a: "الأخوان لوميير", options: ["إديسون", "الأخوان لوميير", "والت ديزني", "تشارلي تشابلن"] },
  { q: "ما هو أكبر بحر مغلق في العالم؟", a: "بحر قزوين", options: ["البحر الميت", "بحر قزوين", "البحر الأحمر", "البحر الأسود"] },
  { q: "كم عدد ألوان علم الكويت؟", a: "4", options: ["3", "4", "5", "6"] },
  { q: "ما هو الحيوان الذي ينام وهو واقف؟", a: "الحصان", options: ["البقرة", "الحصان", "الفيل", "الزرافة"] },
  { q: "ما هي عاصمة الجزائر؟", a: "الجزائر", options: ["وهران", "قسنطينة", "الجزائر", "عنابة"] },
  { q: "من هو صاحب لوحة 'الموناليزا'؟", a: "ليوناردو دا فينشي", options: ["بيكاسو", "ليوناردو دا فينشي", "مايكل أنجلو", "فان جوخ"] },
  { q: "ما هو الغاز الذي يستخدم في تعبئة المناطيد؟", a: "الهيليوم", options: ["الهيدروجين", "الهيليوم", "النيتروجين", "الأكسجين"] },
  { q: "كم عدد أسابيع السنة؟", a: "52", options: ["50", "51", "52", "53"] },
  { q: "ما هي عاصمة ليبيا؟", a: "طرابلس", options: ["بنغازي", "مصراتة", "طرابلس", "طبرق"] },
  { q: "من هو مخترع الطباعة؟", a: "يوهان جوتنبرج", options: ["ليوناردو دا فينشي", "يوهان جوتنبرج", "إديسون", "نيوتن"] },
  { q: "ما هو أكبر عضو في جسم الإنسان؟", a: "الجلد", options: ["الكبد", "الرئة", "الجلد", "الأمعاء"] },
  { q: "كم عدد القلوب لدى الأخطبوط؟", a: "3", options: ["1", "2", "3", "4"] },
  { q: "ما هي عاصمة موريتانيا؟", a: "نواكشوط", options: ["نواذيبو", "نواكشوط", "روصو", "أطار"] },
  { q: "من هو أول من صعد إلى الفضاء؟", a: "يوري جاجارين", options: ["نيل أرمسترونج", "يوري جاجارين", "جون جلين", "بز ألدرين"] },
  { q: "ما هو أطول جسر في العالم؟", a: "جسر دانيانغ-كونشان", options: ["جسر البوابة الذهبية", "جسر دانيانغ-كونشان", "جسر الملك فهد", "جسر الشيخ جابر"] },
  { q: "كم عدد عيون النحلة؟", a: "5", options: ["2", "3", "4", "5"] },
  { q: "ما هي عاصمة الصومال؟", a: "مقديشو", options: ["هرجيسا", "بوساسو", "مقديشو", "كيسمايو"] },
  { q: "من هو مخترع الديناميت؟", a: "ألفريد نوبل", options: ["أينشتاين", "ألفريد نوبل", "نيوتن", "تسلا"] },
  { q: "ما هو أصغر طائر في العالم؟", a: "طنين النحل", options: ["العصفور", "طنين النحل", "الببغاء", "الحمام"] },
  { q: "كم عدد الأوتار في الكمان؟", a: "4", options: ["3", "4", "5", "6"] },
  { q: "ما هي عاصمة جيبوتي؟", a: "جيبوتي", options: ["علي صبيح", "تاجورة", "جيبوتي", "أوبوك"] },
  { q: "من هو مؤلف مسرحية 'هاملت'؟", a: "شكسبير", options: ["شكسبير", "موليير", "برنارد شو", "أوسكار وايلد"] },
  { q: "ما هو أسرع طائر في العالم؟", a: "الصقر الجوال", options: ["النعامة", "الصقر الجوال", "النسر", "البومة"] },
  { q: "كم عدد أجنحة النحلة؟", a: "4", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة جزر القمر؟", a: "موروني", options: ["موتسامودو", "موروني", "فومبوني", "دوموني"] },
  { q: "من هو مخترع المحرك البخاري؟", a: "جيمس واط", options: ["نيوتن", "جيمس واط", "فورد", "إديسون"] },
  { q: "ما هو أثقل كوكب في المجموعة الشمسية؟", a: "المشتري", options: ["زحل", "المشتري", "الأرض", "نبتون"] },
  { q: "كم عدد أرجل النملة؟", a: "6", options: ["4", "6", "8", "10"] },
  { q: "ما هي عاصمة فلسطين؟", a: "القدس", options: ["رام الله", "غزة", "القدس", "نابلس"] },
  { q: "من هو مكتشف البنسلين؟", a: "ألكسندر فليمنج", options: ["باستور", "ألكسندر فليمنج", "كوك", "مندل"] },
  { q: "ما هو أكبر حيوان لا فقاري؟", a: "الحبار العملاق", options: ["الأخطبوط", "الحبار العملاق", "قنديل البحر", "نجم البحر"] },
  { q: "كم عدد أسنان الفيل؟", a: "26", options: ["20", "24", "26", "28"] },
  { q: "ما هي عاصمة اليمن؟", a: "صنعاء", options: ["عدن", "تعز", "صنعاء", "الحديدة"] },
  { q: "من هو مخترع التلغراف؟", a: "صمويل مورس", options: ["بيل", "صمويل مورس", "إديسون", "تسلا"] },
  { q: "ما هو أطول عمر لحيوان؟", a: "سلحفاة غالاباغوس", options: ["الفيل", "الحوت", "سلحفاة غالاباغوس", "الببغاء"] },
  { q: "كم عدد ألوان علم السعودية؟", a: "2", options: ["1", "2", "3", "4"] },
  { q: "ما هي عاصمة العراق القديمة؟", a: "بابل", options: ["نينوى", "بابل", "أور", "بغداد"] },
  { q: "من هو صاحب لقب 'الفاروق'؟", a: "عمر بن الخطاب", options: ["أبو بكر", "عمر بن الخطاب", "عثمان بن عفان", "علي بن أبي طالب"] },
  { q: "ما هو الغاز الذي يملأ المصابيح الكهربائية؟", a: "الأرجون", options: ["النيون", "الأرجون", "الهيليوم", "النيتروجين"] },
  { q: "كم عدد صلوات اليوم والليلة؟", a: "5", options: ["3", "4", "5", "6"] },
  { q: "ما هي عاصمة الدولة الأموية؟", a: "دمشق", options: ["بغداد", "الكوفة", "دمشق", "المدينة"] },
  { q: "من هو أول من بنى الكعبة؟", a: "إبراهيم وإسماعيل", options: ["آدم", "إبراهيم وإسماعيل", "نوح", "سليمان"] },
  { q: "ما هو أطول جبل في العالم؟", a: "إيفرست", options: ["كي 2", "إيفرست", "كليمنجارو", "أطلس"] },
  { q: "كم عدد ركعات صلاة الفجر؟", a: "2", options: ["2", "3", "4", "5"] },
  { q: "ما هي عاصمة الدولة العباسية؟", a: "بغداد", options: ["دمشق", "بغداد", "القاهرة", "سامراء"] },
  { q: "من هو النبي الذي ابتلعه الحوت؟", a: "يونس", options: ["يونس", "يوسف", "موسى", "نوح"] },
  { q: "ما هو أقدم خط عربي؟", a: "الخط الكوفي", options: ["خط النسخ", "خط الرقعة", "الخط الكوفي", "الخط الديواني"] },
  { q: "كم عدد ركعات صلاة المغرب؟", a: "3", options: ["2", "3", "4", "5"] },
  { q: "ما هي عاصمة الأندلس؟", a: "قرطبة", options: ["غرناطة", "إشبيلية", "قرطبة", "طليطلة"] },
  { q: "من هو النبي الذي كلم الله؟", a: "موسى", options: ["إبراهيم", "موسى", "عيسى", "محمد"] },
  { q: "ما هو أطول سور في العالم؟", a: "سور الصين العظيم", options: ["سور برلين", "سور الصين العظيم", "سور القدس", "سور القسطنطينية"] },
  { q: "كم عدد ركعات صلاة الظهر؟", a: "4", options: ["2", "3", "4", "5"] },
  { q: "ما هي عاصمة الدولة العثمانية؟", a: "إسطنبول", options: ["أنقرة", "إسطنبول", "بورصة", "أدرنة"] },
  { q: "من هو النبي الذي صنع السفينة؟", a: "نوح", options: ["نوح", "هود", "صالح", "لوط"] },
  { q: "ما هو أقدم برلمان في العالم؟", a: "برلمان آيسلندا", options: ["برلمان بريطانيا", "برلمان آيسلندا", "برلمان اليونان", "برلمان مصر"] },
  { q: "كم عدد ركعات صلاة العصر؟", a: "4", options: ["2", "3", "4", "5"] },
  { q: "ما هي عاصمة الدولة الفاطمية؟", a: "القاهرة", options: ["المهدية", "القاهرة", "القيروان", "تونس"] },
  { q: "من هو النبي الذي أوتي ملكاً عظيماً؟", a: "سليمان", options: ["داود", "سليمان", "يوسف", "زكريا"] },
  { q: "ما هو أقدم جامعة في العالم؟", a: "جامعة القرويين", options: ["جامعة الأزهر", "جامعة القرويين", "جامعة بولونيا", "جامعة أكسفورد"] },
  { q: "كم عدد ركعات صلاة العشاء؟", a: "4", options: ["2", "3", "4", "5"] },
  { q: "ما هي عاصمة الدولة الأيوبية؟", a: "القاهرة", options: ["دمشق", "حلب", "القاهرة", "القدس"] },
  { q: "من هو النبي الذي صبر على المرض؟", a: "أيوب", options: ["أيوب", "يعقوب", "زكريا", "يحيى"] },
  { q: "ما هو أقدم متحف في العالم؟", a: "متحف كابيتولين", options: ["متحف اللوفر", "متحف كابيتولين", "المتحف البريطاني", "متحف الفاتيكان"] },
  { q: "كم عدد أركان الإسلام؟", a: "5", options: ["3", "4", "5", "6"] },
  { q: "ما هي عاصمة الدولة المملوكية؟", a: "القاهرة", options: ["دمشق", "القاهرة", "بغداد", "مكة"] },
  { q: "من هو النبي الذي رفع إلى السماء؟", a: "عيسى", options: ["إدريس", "عيسى", "إلياس", "اليسع"] },
  { q: "ما هو أقدم عملة في العالم؟", a: "الليديا", options: ["الدينار", "الدرهم", "الليديا", "الجنيه"] },
  { q: "كم عدد أركان الإيمان؟", a: "6", options: ["4", "5", "6", "7"] },
  { q: "ما هي عاصمة الدولة الصفوية؟", a: "أصفهان", options: ["تبريز", "أصفهان", "قزوين", "طهران"] },
  { q: "من هو النبي الذي كان يعمل نجاراً؟", a: "زكريا", options: ["داود", "زكريا", "نوح", "إبراهيم"] },
  { q: "ما هو أقدم علم دولة في العالم؟", a: "علم الدنمارك", options: ["علم اليابان", "علم الدنمارك", "علم بريطانيا", "علم فرنسا"] },
  { q: "كم عدد أبواب الجنة؟", a: "8", options: ["6", "7", "8", "9"] },
  { q: "ما هي عاصمة الدولة الغزنوية؟", a: "غزنة", options: ["لاهور", "غزنة", "كابول", "قندهار"] },
  { q: "من هو النبي الذي كان يعمل حداداً؟", a: "داود", options: ["داود", "سليمان", "موسى", "عيسى"] },
  { q: "ما هو أقدم لغة مكتوبة في العالم؟", a: "السومرية", options: ["المصرية القديمة", "السومرية", "الصينية", "اليونانية"] },
  { q: "كم عدد أبواب النار؟", a: "7", options: ["5", "6", "7", "8"] },
  { q: "ما هي عاصمة الدولة السلجوقية؟", a: "نيسابور", options: ["أصفهان", "نيسابور", "الري", "بغداد"] },
  { q: "من هو النبي الذي كان يعمل راعياً للغنم؟", a: "كل الأنبياء", options: ["محمد", "موسى", "داود", "كل الأنبياء"] },
  { q: "ما هو أقدم مدينة مأهولة في العالم؟", a: "دمشق", options: ["أريحا", "دمشق", "حلب", "جبيل"] },
  { q: "ما هو أكبر خليج في العالم؟", a: "خليج المكسيك", options: ["الخليج العربي", "خليج المكسيك", "خليج البنغال", "خليج غينيا"] },
  { q: "ما هو أطول نهر في أوروبا؟", a: "الفولجا", options: ["الدانوب", "الراين", "الفولجا", "السين"] },
  { q: "ما هي عاصمة كندا؟", a: "أوتاوا", options: ["تورونتو", "مونتريال", "أوتاوا", "فانكوفر"] },
  { q: "ما هو أصغر محيط في العالم؟", a: "المحيط المتجمد الشمالي", options: ["المحيط الهندي", "المحيط المتجمد الشمالي", "المحيط الأطلسي", "المحيط الهادئ"] },
  { q: "من هو مكتشف الدورة الدموية الصغرى؟", a: "ابن النفيس", options: ["ابن سينا", "الرازي", "ابن النفيس", "ويليام هارفي"] },
  { q: "ما هو الغاز الذي يمتص الأشعة فوق البنفسجية؟", a: "الأوزون", options: ["الأكسجين", "النيتروجين", "الأوزون", "الميثان"] },
  { q: "كم عدد فقرات عنق الزرافة؟", a: "7", options: ["7", "14", "21", "28"] },
  { q: "ما هو الطائر الذي يضع أكبر بيضة؟", a: "النعامة", options: ["النسر", "النعامة", "البجعة", "البومة"] },
  { q: "ما هي عاصمة إسبانيا؟", a: "مدريد", options: ["برشلونة", "إشبيلية", "مدريد", "فالنسيا"] },
  { q: "من هو مخترع المجهر؟", a: "ليفينهوك", options: ["نيوتن", "ليفينهوك", "جاليليو", "باستور"] },
  { q: "ما هو أسرع كوكب يدور حول نفسه؟", a: "المشتري", options: ["الأرض", "المريخ", "المشتري", "زحل"] },
  { q: "كم عدد ألوان علم مصر؟", a: "3", options: ["2", "3", "4", "5"] },
  { q: "ما هي عاصمة إيطاليا؟", a: "روما", options: ["ميلانو", "روما", "فينيسيا", "فلورنسا"] },
  { q: "من هو مؤلف كتاب 'حي بن يقظان'؟", a: "ابن طفيل", options: ["ابن رشد", "ابن طفيل", "الغزالي", "ابن خلدون"] },
  { q: "ما هو أكبر طائر في العالم؟", a: "النعامة", options: ["النسر", "النعامة", "البجعة", "اللقلق"] },
  { q: "كم عدد قلوب الأخطبوط؟", a: "3", options: ["1", "2", "3", "4"] },
  { q: "ما هي عاصمة تركيا؟", a: "أنقرة", options: ["إسطنبول", "أنقرة", "بورصة", "أزمير"] },
  { q: "من هو مكتشف الجراثيم؟", a: "لويس باستور", options: ["روبرت كوخ", "لويس باستور", "فليمنج", "مندل"] },
  { q: "ما هو أثقل غاز في العالم؟", a: "الرادون", options: ["الأكسجين", "النيتروجين", "الرادون", "الهيدروجين"] },
  { q: "كم عدد أذرع الأخطبوط؟", a: "8", options: ["6", "8", "10", "12"] },
  { q: "ما هي عاصمة اليونان؟", a: "أثينا", options: ["أثينا", "سبارتا", "كريت", "رودس"] },
  { q: "من هو مخترع الآلة الحاسبة؟", a: "بليز باسكال", options: ["نيوتن", "بليز باسكال", "إديسون", "تسلا"] },
  { q: "ما هو أطول حيوان في العالم؟", a: "الزرافة", options: ["الفيل", "الزرافة", "الحوت الأزرق", "النعامة"] },
  { q: "كم عدد عيون الذبابة؟", a: "5", options: ["2", "3", "4", "5"] },
  { q: "ما هي عاصمة البرتغال؟", a: "لشبونة", options: ["بورتو", "لشبونة", "فارو", "براغا"] },
  { q: "من هو مخترع المحرك النفاث؟", a: "فرانك ويتل", options: ["جيمس واط", "فرانك ويتل", "فورد", "رايت"] },
  { q: "ما هو أصغر عظمة في جسم الإنسان؟", a: "الركاب", options: ["المطرقة", "السندان", "الركاب", "الترقوة"] },
  { q: "كم عدد أسنان القطة؟", a: "30", options: ["20", "26", "30", "32"] },
  { q: "ما هي عاصمة سويسرا؟", a: "برن", options: ["جنيف", "زيورخ", "برن", "بازل"] },
  { q: "من هو مكتشف غاز الأكسجين؟", a: "جوزيف بريستلي", options: ["لافوازييه", "جوزيف بريستلي", "كافنديش", "دالتون"] },
  { q: "ما هو أسرع سمكة في العالم؟", a: "سمكة الشراع", options: ["القرش", "سمكة الشراع", "التونة", "الدلفين"] },
  { q: "كم عدد أجنحة الفراشة؟", a: "4", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة هولندا؟", a: "أمستردام", options: ["روتردام", "لاهاي", "أمستردام", "أوتريخت"] },
  { q: "من هو مخترع التلسكوب؟", a: "جاليليو", options: ["نيوتن", "جاليليو", "كبلر", "هابل"] },
  { q: "ما هو أطول ثعبان في العالم؟", a: "الأناكوندا", options: ["الكوبرا", "الأناكوندا", "البايثون", "الأفعى المجلجلة"] },
  { q: "كم عدد أرجل السرطان؟", a: "10", options: ["6", "8", "10", "12"] },
  { q: "ما هي عاصمة بلجيكا؟", a: "بروكسل", options: ["أنتويرب", "غنت", "بروكسل", "لييج"] },
  { q: "من هو مكتشف قارة أستراليا؟", a: "جيمس كوك", options: ["ماجلان", "جيمس كوك", "كولومبوس", "دي جاما"] },
  { q: "ما هو أثقل طائر يطير؟", a: "الحبارى الكبرى", options: ["النسر", "البجعة", "الحبارى الكبرى", "اللقلق"] },
  { q: "كم عدد عيون العنكبوت؟", a: "8", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة النمسا؟", a: "فيينا", options: ["سالزبورغ", "فيينا", "غراتس", "لينز"] },
  { q: "من هو مخترع البطارية؟", a: "أليساندرو فولتا", options: ["أمبير", "أليساندرو فولتا", "فاراداي", "أوم"] },
  { q: "ما هو أطول نهر في آسيا؟", a: "يانغتسي", options: ["الغانج", "يانغتسي", "السند", "الفرات"] },
  { q: "كم عدد أسنان الكلب؟", a: "42", options: ["32", "38", "42", "46"] },
  { q: "ما هي عاصمة السويد؟", a: "ستوكهولم", options: ["غوتنبرغ", "مالمو", "ستوكهولم", "أوبسالا"] },
  { q: "من هو مكتشف غاز النيتروجين؟", a: "دانيال رذرفورد", options: ["بريستلي", "دانيال رذرفورد", "لافوازييه", "كافنديش"] },
  { q: "ما هو أسرع حيوان بحري؟", a: "سمكة السيف", options: ["القرش", "سمكة السيف", "الدلفين", "الحوت"] },
  { q: "كم عدد أجنحة البعوضة؟", a: "2", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة النرويج؟", a: "أوسلو", options: ["بيرغن", "تروندهايم", "أوسلو", "ستافانغر"] },
  { q: "من هو مخترع المظلة؟", a: "سيباستيان لينورماند", options: ["دا فينشي", "سيباستيان لينورماند", "رايت", "فورد"] },
  { q: "ما هو أطول جبل في أفريقيا؟", a: "كليمنجارو", options: ["أطلس", "كليمنجارو", "كينيا", "ستانلي"] },
  { q: "كم عدد أرجل الجندب؟", a: "6", options: ["4", "6", "8", "10"] },
  { q: "ما هي عاصمة الدنمارك؟", a: "كوبنهاجن", options: ["آرهوس", "أودنسه", "كوبنهاجن", "ألبورغ"] },
  { q: "من هو مكتشف غاز الهيدروجين؟", a: "هنري كافنديش", options: ["بريستلي", "هنري كافنديش", "لافوازييه", "دالتون"] },
  { q: "ما هو أثقل حيوان في العالم؟", a: "الحوت الأزرق", options: ["الفيل", "الحوت الأزرق", "القرش", "فرس النهر"] },
  { q: "كم عدد عيون النملة؟", a: "2", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة فنلندا؟", a: "هلسنكي", options: ["تامبيري", "توركو", "هلسنكي", "إسبو"] },
  { q: "من هو مخترع البوصلة؟", a: "الصينيون", options: ["العرب", "الصينيون", "اليونانيون", "الرومان"] },
  { q: "ما هو أطول نهر في أمريكا الشمالية؟", a: "ميسوري", options: ["ميسيسيبي", "ميسوري", "يوكون", "ريو غراندي"] },
  { q: "كم عدد أسنان التمساح؟", a: "80", options: ["40", "60", "80", "100"] },
  { q: "ما هي عاصمة بولندا؟", a: "وارسو", options: ["كراكوف", "وارسو", "غدانسك", "ووتش"] },
  { q: "من هو مكتشف غاز الهيليوم؟", a: "بيير جانسين", options: ["بريستلي", "بيير جانسين", "كافنديش", "رذرفورد"] },
  { q: "ما هو أسرع إنسان في العالم؟", a: "يوسين بولت", options: ["كارل لويس", "يوسين بولت", "تايسون غاي", "يوهان بليك"] },
  { q: "كم عدد أجنحة الذبابة؟", a: "2", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة المجر؟", a: "بودابست", options: ["دبرتسن", "سيجد", "بودابست", "بيتش"] },
  { q: "من هو مخترع الميكروفون؟", a: "إميل برلينر", options: ["إديسون", "إميل برلينر", "بيل", "تسلا"] },
  { q: "ما هو أطول جبل في أمريكا الشمالية؟", a: "دينالي", options: ["لوغان", "دينالي", "رينيه", "سانت إلياس"] },
  { q: "كم عدد أرجل العقرب؟", a: "8", options: ["6", "8", "10", "12"] },
  { q: "ما هي عاصمة التشيك؟", a: "براغ", options: ["برنو", "أوسترافا", "براغ", "بلزن"] },
  { q: "من هو مكتشف غاز ثاني أكسيد الكربون؟", a: "جوزيف بلاك", options: ["بريستلي", "جوزيف بلاك", "كافنديش", "لافوازييه"] },
  { q: "ما هو أثقل معدن في العالم؟", a: "الأوزميوم", options: ["الرصاص", "الذهب", "الأوزميوم", "البلاتين"] },
  { q: "كم عدد عيون النحلة؟", a: "5", options: ["2", "3", "4", "5"] },
  { q: "ما هي عاصمة رومانيا؟", a: "بوخارست", options: ["كلوج", "تيميشوارا", "بوخارست", "ياش"] },
  { q: "من هو مخترع الكاميرا؟", a: "لويس داجير", options: ["نيبس", "لويس داجير", "إديسون", "إيستمان"] },
  { q: "ما هو أطول نهر في أفريقيا؟", a: "النيل", options: ["الكونغو", "النيجر", "النيل", "زمبيزي"] },
  { q: "كم عدد أسنان القرش؟", a: "3000", options: ["1000", "2000", "3000", "4000"] },
  { q: "ما هي عاصمة بلغاريا؟", a: "صوفيا", options: ["بلوفديف", "فارنا", "صوفيا", "بورغاس"] },
  { q: "من هو مكتشف غاز الأرجون؟", a: "ويليام رامزي", options: ["رذرفورد", "ويليام رامزي", "كافنديش", "بريستلي"] },
  { q: "ما هو أسرع قطار في العالم؟", a: "ماغليف", options: ["تي جي في", "شينكانسن", "ماغليف", "يوروستار"] },
  { q: "كم عدد أجنحة اليعسوب؟", a: "4", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة كرواتيا؟", a: "زغرب", options: ["سبليت", "رييكا", "زغرب", "زادار"] },
  { q: "من هو مخترع الغسالة؟", a: "ألفا فيشر", options: ["إديسون", "ألفا فيشر", "فورد", "تسلا"] },
  { q: "ما هو أطول جبل في أمريكا الجنوبية؟", a: "أكونكاغوا", options: ["أوجوس ديل سالادو", "أكونكاغوا", "بيسيس", "هواسكاران"] },
  { q: "كم عدد أرجل المئوية؟", a: "100", options: ["50", "100", "150", "200"] },
  { q: "ما هي عاصمة صربيا؟", a: "بلجراد", options: ["نوفي ساد", "نيش", "بلجراد", "كراغوييفاتس"] },
  { q: "من هو مكتشف غاز النيون؟", a: "ويليام رامزي", options: ["رذرفورد", "ويليام رامزي", "كافنديش", "بريستلي"] },
  { q: "ما هو أثقل سائل في العالم؟", a: "الزئبق", options: ["الماء", "الزيت", "الزئبق", "الحليب"] },
  { q: "كم عدد عيون الأخطبوط؟", a: "2", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة سلوفاكيا؟", a: "براتيسلافا", options: ["كوشيتسه", "براتيسلافا", "بريشوف", "زيلينا"] },
  { q: "من هو مخترع المكنسة الكهربائية؟", a: "هوبرت بوث", options: ["إديسون", "هوبرت بوث", "هوفر", "تسلا"] },
  { q: "ما هو أطول نهر في أستراليا؟", a: "موراي", options: ["دارلينج", "موراي", "فيتزروي", "أورد"] },
  { q: "كم عدد أسنان الحصان؟", a: "40", options: ["30", "36", "40", "44"] },
  { q: "ما هي عاصمة سلوفينيا؟", a: "ليوبليانا", options: ["ماريبور", "ليوبليانا", "تسيليه", "كراني"] },
  { q: "من هو مكتشف غاز الكريبتون؟", a: "ويليام رامزي", options: ["رذرفورد", "ويليام رامزي", "كافنديش", "بريستلي"] },
  { q: "ما هو أسرع طائرة في العالم؟", a: "إكس-15", options: ["كونكورد", "إكس-15", "إس آر-71", "إف-22"] },
  { q: "كم عدد أجنحة الخنفساء؟", a: "4", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة إستونيا؟", a: "تالين", options: ["تارتو", "تالين", "نارفا", "بارنو"] },
  { q: "من هو مخترع الثلاجة؟", a: "ويليام كولين", options: ["إديسون", "ويليام كولين", "فورد", "تسلا"] },
  { q: "ما هو أطول جبل في أوروبا؟", a: "إلبروس", options: ["مون بلان", "إلبروس", "ماترهورن", "أوليمبوس"] },
  { q: "كم عدد أرجل الألفية؟", a: "1000", options: ["500", "750", "1000", "1250"] },
  { q: "ما هي عاصمة لاتفيا؟", a: "ريغا", options: ["داوجافبيلس", "ليبايا", "ريغا", "جيلجافا"] },
  { q: "من هو مكتشف غاز الزينون؟", a: "ويليام رامزي", options: ["رذرفورد", "ويليام رامزي", "كافنديش", "بريستلي"] },
  { q: "ما هو أثقل صخر في العالم؟", a: "البازلت", options: ["الجرانيت", "البازلت", "الرخام", "الحجر الجيري"] },
  { q: "كم عدد عيون الذبابة المنزلية؟", a: "2", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة ليتوانيا؟", a: "فيلنيوس", options: ["كاوناس", "كلايبيدا", "فيلنيوس", "شياولياي"] },
  { q: "من هو مخترع غسالة الصحون؟", a: "جوزفين كوكرين", options: ["إديسون", "جوزفين كوكرين", "فورد", "تسلا"] },
  { q: "ما هو أطول نهر في أمريكا الجنوبية؟", a: "الأمازون", options: ["بارانا", "الأمازون", "أورينوكو", "ساو فرانسيسكو"] },
  { q: "كم عدد أسنان البقرة؟", a: "32", options: ["24", "28", "32", "36"] },
  { q: "ما هي عاصمة أيسلندا؟", a: "ريكيافيك", options: ["أكورييري", "ريكيافيك", "كوبافوغور", "هافنارفجوردور"] },
  { q: "من هو مكتشف غاز الرادون؟", a: "فريدريش دورن", options: ["رذرفورد", "فريدريش دورن", "كافنديش", "بريستلي"] },
  { q: "ما هو أسرع سيارة في العالم؟", a: "بوغاتي شيرون", options: ["فيراري", "لامبورغيني", "بوغاتي شيرون", "كوينيجسيج"] },
  { q: "كم عدد أجنحة الجرادة؟", a: "4", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة ألبانيا؟", a: "تيرانا", options: ["دراس", "فلورا", "تيرانا", "إلباسان"] },
  { q: "من هو مخترع التكييف؟", a: "ويليس كارير", options: ["إديسون", "ويليس كارير", "فورد", "تسلا"] },
  { q: "ما هو أطول جبل في أوقيانوسيا؟", a: "بونتشاك جايا", options: ["كوسيوسكو", "بونتشاك جايا", "كوك", "ويلهلم"] },
  { q: "كم عدد أرجل الروبيان؟", a: "10", options: ["6", "8", "10", "12"] },
  { q: "ما هي عاصمة مقدونيا الشمالية؟", a: "سكوبيه", options: ["بيتولا", "أوخريد", "سكوبيه", "كومانوفو"] },
  { q: "من هو مكتشف غاز الفلور؟", a: "هنري مويسان", options: ["بريستلي", "هنري مويسان", "كافنديش", "لافوازييه"] },
  { q: "ما هو أثقل عنصر طبيعي؟", a: "اليورانيوم", options: ["الرصاص", "الذهب", "اليورانيوم", "البلاتين"] },
  { q: "كم عدد عيون العقرب؟", a: "12", options: ["2", "6", "8", "12"] },
  { q: "ما هي عاصمة الجبل الأسود؟", a: "بودغوريتسا", options: ["نيكسيتش", "بودغوريتسا", "بليفلجا", "بيجيلو بولي"] },
  { q: "من هو مخترع الميكروويف؟", a: "بيرسي سبنسر", options: ["إديسون", "بيرسي سبنسر", "فورد", "تسلا"] },
  { q: "ما هو أطول نهر في بريطانيا؟", a: "سيفيرن", options: ["التايمز", "سيفيرن", "ترينت", "أوز"] },
  { q: "كم عدد أسنان الأرنب؟", a: "28", options: ["20", "24", "28", "32"] },
  { q: "ما هي عاصمة البوسنة والهرسك؟", a: "سراييفو", options: ["بانيا لوكا", "توزلا", "سراييفو", "موستار"] },
  { q: "من هو مكتشف غاز الكلور؟", a: "كارل شيله", options: ["بريستلي", "كارل شيله", "كافنديش", "لافوازييه"] },
  { q: "ما هو أسرع حيوان في العالم؟", a: "الصقر الجوال", options: ["الفهد", "الصقر الجوال", "السمكة الشراعية", "اليعسوب"] },
  { q: "كم عدد أجنحة النملة الطائرة؟", a: "4", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة مولدوفا؟", a: "كيشيناو", options: ["تيراسبول", "بالتي", "كيشيناو", "بندر"] },
  { q: "من هو مخترع ماكينة الخياطة؟", a: "إلياس هاو", options: ["إديسون", "إلياس هاو", "سينجر", "تسلا"] },
  { q: "ما هو أطول جبل في القارة القطبية الجنوبية؟", a: "فينسون ماسيف", options: ["تاييري", "فينسون ماسيف", "كيركباتريك", "ماركهام"] },
  { q: "كم عدد أرجل القملة؟", a: "6", options: ["4", "6", "8", "10"] },
  { q: "ما هي عاصمة قبرص؟", a: "نيقوسيا", options: ["ليماسول", "لارنكا", "نيقوسيا", "بافوس"] },
  { q: "من هو مكتشف غاز البروم؟", a: "أنطوان جيرار", options: ["بريستلي", "أنطوان جيرار", "كافنديش", "لافوازييه"] },
  { q: "ما هو أثقل كوكب صخري؟", a: "الأرض", options: ["الزهرة", "المريخ", "الأرض", "عطارد"] },
  { q: "كم عدد عيون الحبار؟", a: "2", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة مالطا؟", a: "فاليتا", options: ["بيرغو", "فاليتا", "سليمة", "مدينا"] },
  { q: "من هو مخترع المحرك الكهربائي؟", a: "مايكل فاراداي", options: ["إديسون", "مايكل فاراداي", "تسلا", "أمبير"] },
  { q: "ما هو أطول نهر في فرنسا؟", a: "لوار", options: ["السين", "الرون", "لوار", "غارون"] },
  { q: "كم عدد أسنان الفأر؟", a: "16", options: ["12", "14", "16", "18"] },
  { q: "ما هي عاصمة لوكسمبورغ؟", a: "لوكسمبورغ", options: ["إيش", "ديفردانج", "لوكسمبورغ", "دوديلانج"] },
  { q: "من هو مكتشف غاز اليود؟", a: "برنارد كورتوا", options: ["بريستلي", "برنارد كورتوا", "كافنديش", "لافوازييه"] },
  { q: "ما هو أسرع حشرة في العالم؟", a: "اليعسوب", options: ["النحلة", "اليعسوب", "الصرصور", "الذباب"] },
  { q: "كم عدد أجنحة الزنبور؟", a: "4", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة أندورا؟", a: "أندورا لا فيلا", options: ["إيسكالدس", "أندورا لا فيلا", "إنكامب", "سانت جوليا"] },
  { q: "من هو مخترع الترانزستور؟", a: "جون باردين", options: ["إديسون", "جون باردين", "تسلا", "بيل"] },
  { q: "ما هو أطول جبل في اليابان؟", a: "فوجي", options: ["كيتا", "فوجي", "هوتاكا", "ياري"] },
  { q: "كم عدد أرجل القراد؟", a: "8", options: ["4", "6", "8", "10"] },
  { q: "ما هي عاصمة موناكو؟", a: "موناكو", options: ["مونت كارلو", "موناكو", "فونتفيل", "لا كوندامين"] },
  { q: "من هو مكتشف غاز الفوسفور؟", a: "هنيغ براند", options: ["بريستلي", "هنيغ براند", "كافنديش", "لافوازييه"] },
  { q: "ما هو أثقل طائر لا يطير؟", a: "النعامة", options: ["البطريق", "النعامة", "إيمو", "كاسواري"] },
  { q: "كم عدد عيون الحلزون؟", a: "2", options: ["2", "4", "6", "8"] },
  { q: "ما هي عاصمة سان مارينو؟", a: "سان مارينو", options: ["دوغانا", "سان مارينو", "بورغو ماجيوري", "أكوافيفا"] },
  { q: "من هو مخترع الليزر؟", a: "ثيودور ميمان", options: ["أينشتاين", "ثيودور ميمان", "تسلا", "إديسون"] },
  { q: "ما هو أطول نهر في ألمانيا؟", a: "الراين", options: ["الدانوب", "إلبه", "الراين", "ويسر"] },
  { q: "كم عدد أسنان الهامستر؟", a: "16", options: ["12", "14", "16", "18"] },
  { q: "ما هي عاصمة ليختنشتاين؟", a: "فادوز", options: ["شان", "فادوز", "تريسن", "بالزرس"] },
  { q: "من هو مكتشف غاز الكبريت؟", a: "القدماء", options: ["لافوازييه", "القدماء", "بريستلي", "كافنديش"] }
];

export const TriviaGame: React.FC<TriviaGameProps> = ({ messages, onLeave, channelName, isConnected, error }) => {
  const [phase, setPhase] = useState<GamePhase>('config');
  const [settings, setSettings] = useState({ numQuestions: 10, timePerQuestion: 15 });
  const [players, setPlayers] = useState<Record<string, Player>>({});
  const [currentQuestion, setCurrentQuestion] = useState(1);
  const [timeLeft, setTimeLeft] = useState<number | null>(null);
  const [questionData, setQuestionData] = useState<QuestionData | null>(null);
  const [streamerSecretAnswer, setStreamerSecretAnswer] = useState('');
  const [lockedStreamerAnswer, setLockedStreamerAnswer] = useState('');
  const [showStreamerBox, setShowStreamerBox] = useState(true);
  
  const processedMessageIds = useRef<Set<string>>(new Set());

  useEffect(() => {
    messages.forEach(msg => {
      if (!processedMessageIds.current.has(msg.id)) {
        processedMessageIds.current.add(msg.id);
        
        const text = msg.message.trim();
        
        if (phase === 'joining' && text.toLowerCase() === '!join') {
          setPlayers(prev => {
            if (!prev[msg.username]) {
              return { ...prev, [msg.username]: { username: msg.username, score: 0 } };
            }
            return prev;
          });
        } else if (phase === 'playing' && timeLeft !== null && timeLeft > 0) {
          setPlayers(prev => {
            const player = prev[msg.username];
            if (player && !player.currentAnswer) {
              // Only capture numbers from the chat message
              const numMatch = text.match(/\d+/);
              if (!numMatch) return prev;
              
              const answer = numMatch[0];
              return {
                ...prev,
                [msg.username]: {
                  ...player,
                  currentAnswer: answer,
                  answerTime: timeLeft
                }
              };
            }
            return prev;
          });
        }
      }
    });
  }, [messages, phase, timeLeft]);

  useEffect(() => {
    if (phase === 'playing' && timeLeft !== null && timeLeft > 0) {
      const timer = setTimeout(() => setTimeLeft(prev => (prev !== null ? prev - 1 : null)), 1000);
      return () => clearTimeout(timer);
    } else if (phase === 'playing' && timeLeft === 0) {
      handleRoundEnd();
    }
  }, [phase, timeLeft]);

  const setRandomQuestion = () => {
    const randomQ = ARABIC_QUESTIONS[Math.floor(Math.random() * ARABIC_QUESTIONS.length)];
    const shuffledOptions = [...randomQ.options].sort(() => Math.random() - 0.5);
    setQuestionData({
      q: randomQ.q,
      a: randomQ.a,
      options: shuffledOptions
    });
  };

  const startGame = () => {
    setPhase('joining');
  };

  const startFirstQuestion = () => {
    setPhase('playing');
    setCurrentQuestion(1);
    setTimeLeft(settings.timePerQuestion);
    setStreamerSecretAnswer('');
    setLockedStreamerAnswer('');
    setRandomQuestion();
    setPlayers(prev => {
      const next = { ...prev };
      Object.keys(next).forEach(k => {
        next[k].currentAnswer = undefined;
        next[k].answerTime = undefined;
        next[k].roundPoints = 0;
      });
      return next;
    });
  };

  const startNextQuestion = () => {
    if (currentQuestion >= settings.numQuestions) {
      setPhase('final_results');
      return;
    }
    setPhase('playing');
    setCurrentQuestion(prev => prev + 1);
    setTimeLeft(settings.timePerQuestion);
    setStreamerSecretAnswer('');
    setLockedStreamerAnswer('');
    setRandomQuestion();
    setPlayers(prev => {
      const next = { ...prev };
      Object.keys(next).forEach(k => {
        next[k].currentAnswer = undefined;
        next[k].answerTime = undefined;
        next[k].roundPoints = 0;
      });
      return next;
    });
  };

  const handleSecretSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    if (streamerSecretAnswer.trim() && timeLeft !== null && timeLeft > 0) {
      setLockedStreamerAnswer(streamerSecretAnswer.trim().toLowerCase());
      
      setPlayers(prev => {
        const streamerName = channelName || 'Streamer';
        const player = prev[streamerName] || { username: streamerName, score: 0 };
        
        if (!player.currentAnswer) {
          return {
            ...prev,
            [streamerName]: {
              ...player,
              currentAnswer: streamerSecretAnswer.trim(),
              answerTime: timeLeft
            }
          };
        }
        return prev;
      });
    }
  };

  const checkAnswer = (playerAnswer: string | undefined): boolean => {
    if (!playerAnswer || !questionData) return false;
    const ans = playerAnswer.toLowerCase().trim();
    const correctText = questionData.a.toLowerCase().trim();
    const correctIndex = (questionData.options.findIndex(o => o.toLowerCase().trim() === correctText) + 1).toString();
    
    return ans.includes(correctText) || correctText.includes(ans) || ans === correctIndex;
  };

  const handleRoundEnd = () => {
    setPlayers(prev => {
      const next = { ...prev };
      Object.keys(next).forEach(k => {
        const p = next[k];
        let points = 0;
        if (checkAnswer(p.currentAnswer)) {
          const timeTaken = settings.timePerQuestion - (p.answerTime || 0);
          // Highest is 86 points, drops by 3 points every second
          points = Math.max(0, 86 - (timeTaken * 3));
        }
        p.roundPoints = points;
        p.score += points;
      });
      return next;
    });
    setPhase('round_results');
  };

  const sortedPlayers = (Object.values(players) as Player[]).sort((a, b) => b.score - a.score);
  const activePlayers = Object.values(players) as Player[];

  const renderPhase = () => {
    if (phase === 'config') {
      return (
        <div className="flex flex-col items-center justify-center h-full w-full max-w-2xl mx-auto">
          <div className="bg-zinc-800/50 border border-zinc-700 p-8 rounded-2xl w-full">
            <h2 className="text-3xl font-bold text-white mb-6 flex items-center gap-3">
              <Settings className="w-8 h-8 text-brand-gold" />
              إعدادات اللعبة
            </h2>
            
            <div className="space-y-8">
              <div>
                <label className="block text-sm font-medium text-zinc-400 mb-4">عدد الأسئلة</label>
                <div className="grid grid-cols-5 gap-3">
                  {[5, 10, 15, 20, 25].map(num => (
                    <button
                      key={num}
                      onClick={() => setSettings({...settings, numQuestions: num})}
                      className={`py-3 rounded-xl font-bold transition-all border ${
                        settings.numQuestions === num 
                          ? 'bg-brand-gold border-brand-gold-light text-black shadow-[0_0_15px_rgba(212,175,55,0.4)]' 
                          : 'bg-zinc-900 border-zinc-700 text-zinc-400 hover:border-zinc-500'
                      }`}
                    >
                      {num}
                    </button>
                  ))}
                </div>
              </div>

              <div>
                <label className="block text-sm font-medium text-zinc-400 mb-4">الوقت لكل سؤال (ثانية)</label>
                <div className="grid grid-cols-4 gap-3">
                  {[15, 20, 25, 30].map(sec => (
                    <button
                      key={sec}
                      onClick={() => setSettings({...settings, timePerQuestion: sec})}
                      className={`py-3 rounded-xl font-bold transition-all border ${
                        settings.timePerQuestion === sec 
                          ? 'bg-brand-gold border-brand-gold-light text-black shadow-[0_0_15px_rgba(212,175,55,0.4)]' 
                          : 'bg-zinc-900 border-zinc-700 text-zinc-400 hover:border-zinc-500'
                      }`}
                    >
                      {sec}
                    </button>
                  ))}
                </div>
              </div>
              
              <button 
                onClick={startGame}
                className="w-full bg-brand-gold hover:bg-brand-gold-light text-black font-bold py-4 rounded-xl transition-colors flex items-center justify-center gap-2 mt-8 shadow-[0_0_20px_rgba(212,175,55,0.2)]"
              >
                <Play className="w-5 h-5" /> بدء اللعبة
              </button>
            </div>
          </div>
        </div>
      );
    }

    if (phase === 'joining') {
      return (
        <div className="flex flex-col items-center justify-center h-full w-full font-arabic" dir="rtl">
          <h2 className="text-4xl font-bold text-white mb-4">بانتظار اللاعبين</h2>
          <p className="text-xl text-zinc-400 mb-8">
            اكتب <span className="text-brand-gold font-mono bg-brand-gold/10 px-3 py-1 rounded-lg border border-brand-gold/20">!join</span> في الدردشة للدخول
          </p>
          
          <div className="bg-zinc-800/50 border border-zinc-700 rounded-2xl p-6 w-full max-w-2xl mb-8 min-h-[200px] max-h-[400px] overflow-y-auto">
            <div className="flex items-center justify-between mb-4">
              <h3 className="text-lg font-medium text-zinc-300">اللاعبون المنضمون</h3>
              <span className="bg-brand-gold/20 text-brand-gold px-3 py-1 rounded-full text-sm font-bold border border-brand-gold/30">
                المجموع {activePlayers.length}
              </span>
            </div>
            <div className="flex flex-wrap gap-3">
              {activePlayers.map((p, i) => (
                <div key={p.username} className="bg-zinc-900 border border-zinc-700 px-4 py-2 rounded-lg flex items-center gap-2">
                  <span className="text-zinc-500 text-sm">#{i + 1}</span>
                  <span className="text-zinc-200 font-medium">{p.username}</span>
                </div>
              ))}
              {activePlayers.length === 0 && (
                <div className="text-zinc-500 italic w-full text-center py-8">لم ينضم أي لاعب بعد...</div>
              )}
            </div>
          </div>

          <button 
            onClick={startFirstQuestion}
            disabled={activePlayers.length === 0}
            className="bg-brand-gold hover:bg-brand-gold-light disabled:bg-zinc-800 disabled:text-zinc-600 text-black font-bold py-4 px-12 rounded-xl transition-colors flex items-center justify-center gap-2 text-lg shadow-[0_0_30px_rgba(212,175,55,0.2)]"
          >
            بدء الجولة 1 <ArrowRight className="w-5 h-5 rotate-180" />
          </button>
        </div>
      );
    }

    if (phase === 'playing') {
      return (
        <div className="flex h-full w-full gap-6 relative font-arabic" dir="rtl">
          
          {/* Draggable Streamer Secret Box */}
          {showStreamerBox && (
            <motion.div
              drag
              dragMomentum={false}
              className="absolute z-50 top-4 right-4 bg-black/90 backdrop-blur-md border-2 border-brand-gold/50 rounded-xl p-4 shadow-2xl w-80 cursor-move"
            >
              <div className="flex items-center justify-between mb-4">
                <h3 className="text-sm font-bold text-brand-gold flex items-center gap-2">
                  <GripHorizontal className="w-4 h-4" /> تحكم الستريمر السري
                </h3>
                <button onClick={() => setShowStreamerBox(false)} className="text-zinc-500 hover:text-white transition-colors">
                  <XCircle className="w-5 h-5" />
                </button>
              </div>
              <form onSubmit={handleSecretSubmit} className="space-y-3">
                <div>
                  <label className="text-xs text-zinc-400 block mb-1">إجابتك (مخفية عن البث)</label>
                  <div className="relative">
                    <input
                      type="password"
                      value={streamerSecretAnswer}
                      onChange={e => setStreamerSecretAnswer(e.target.value)}
                      placeholder="اكتب إجابتك هنا..."
                      className="w-full bg-black border border-brand-gold/30 rounded-lg pr-10 pl-4 py-2 text-white text-sm focus:ring-2 focus:ring-brand-gold outline-none"
                      onPointerDownCapture={e => e.stopPropagation()} // Prevent drag when typing
                    />
                    <EyeOff className="w-4 h-4 text-zinc-500 absolute right-3 top-2.5" />
                  </div>
                </div>
                {lockedStreamerAnswer ? (
                  <div className="text-xs text-brand-gold text-center bg-brand-gold/10 py-2 rounded-lg border border-brand-gold/20">
                    تم إرسال الإجابة!
                  </div>
                ) : (
                  <p className="text-xs text-zinc-500 leading-tight text-center">
                    اضغط Enter لإرسال إجابتك.
                  </p>
                )}
              </form>
            </motion.div>
          )}

          {!showStreamerBox && (
            <button
              onClick={() => setShowStreamerBox(true)}
              className="absolute top-4 right-4 bg-brand-gold/10 hover:bg-brand-gold/20 text-brand-gold border border-brand-gold/30 px-4 py-2 rounded-lg flex items-center gap-2 text-sm transition-colors z-10"
            >
              <EyeOff className="w-4 h-4" /> إظهار الصندوق السري
            </button>
          )}

          {/* Main Question Area */}
          <div className="flex-1 flex flex-col relative">
            <div className="flex items-center justify-between mb-6">
              <div className="bg-zinc-800/80 border border-zinc-700 px-4 py-2 rounded-lg text-zinc-300 font-medium">
                سؤال {currentQuestion} / {settings.numQuestions}
              </div>
              <div className={`flex items-center gap-2 text-3xl font-bold font-mono px-6 py-3 rounded-xl border ${timeLeft !== null && timeLeft <= 5 ? 'bg-red-500/20 border-red-500/50 text-red-400 animate-pulse' : 'bg-zinc-800/80 border-zinc-700 text-white'}`} dir="ltr">
                <Clock className="w-6 h-6" /> 00:{timeLeft?.toString().padStart(2, '0') || '00'}
              </div>
            </div>

            <div className="flex-1 bg-zinc-800/30 border border-zinc-700/50 rounded-2xl p-8 flex flex-col items-center justify-center relative">
              <h2 className="text-4xl md:text-5xl font-bold text-white text-center mb-12 leading-tight">
                {questionData?.q}
              </h2>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-3xl">
                {questionData?.options.map((opt, i) => (
                  <div key={i} className="bg-black/60 border border-brand-gold/20 p-6 rounded-xl text-center text-2xl font-bold text-white flex items-center justify-start gap-4 shadow-lg hover:border-brand-gold/50 transition-all">
                    <span className="bg-brand-gold/20 text-brand-gold w-10 h-10 rounded-lg flex items-center justify-center text-xl shrink-0 border border-brand-gold/30">
                      {i + 1}
                    </span>
                    <span className="flex-1 text-right">{opt}</span>
                  </div>
                ))}
              </div>
              
              <p className="mt-8 text-zinc-400 text-lg">
                اكتب <span className="text-brand-gold font-bold">رقم الإجابة</span> في الدردشة للمشاركة!
              </p>
            </div>
          </div>

          {/* Live Leaderboard Sidebar */}
          <div className="w-80 flex flex-col gap-4">
            <div className="flex-1 bg-black/40 backdrop-blur-md border border-brand-gold/20 rounded-xl p-4 flex flex-col min-h-0">
              <h3 className="text-sm font-medium text-zinc-400 mb-3 flex items-center gap-2">
                <Trophy className="w-4 h-4 text-brand-gold" /> لوحة الصدارة المباشرة
              </h3>
              <div className="flex-1 overflow-y-auto space-y-2 pr-2">
                {sortedPlayers.map((p, i) => (
                  <div key={p.username} className="flex items-center justify-between bg-white/5 px-3 py-2 rounded-lg border border-white/5">
                    <div className="flex items-center gap-3 overflow-hidden">
                      <span className={`font-bold text-sm ${i === 0 ? 'text-brand-gold' : i === 1 ? 'text-zinc-300' : i === 2 ? 'text-brand-gold/70' : 'text-zinc-500'}`}>
                        #{i + 1}
                      </span>
                      <span className="text-zinc-200 text-sm truncate">{p.username}</span>
                    </div>
                    <div className="flex items-center gap-3">
                      <span className="text-brand-gold font-mono text-sm">{p.score}</span>
                      {p.currentAnswer ? (
                        <CheckCircle2 className="w-4 h-4 text-brand-gold shrink-0" />
                      ) : (
                        <div className="w-4 h-4 rounded-full border-2 border-brand-gold/20 border-t-brand-gold animate-spin shrink-0" />
                      )}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    }

    if (phase === 'round_results') {
      const correctPlayers = activePlayers.filter(p => checkAnswer(p.currentAnswer));
      const fastestPlayer = [...correctPlayers].sort((a, b) => (b.answerTime || 0) - (a.answerTime || 0))[0];

      return (
        <div className="flex flex-col items-center justify-center h-full w-full max-w-4xl mx-auto font-arabic" dir="rtl">
          <h2 className="text-3xl font-bold text-white mb-2">نتائج الجولة {currentQuestion}</h2>
          {questionData && <p className="text-xl text-zinc-300 mb-6 text-center">"{questionData.q}"</p>}
          
          <div className="bg-black/60 border border-brand-gold/20 rounded-2xl p-6 w-full mb-6 flex justify-between items-center">
            <div>
              <p className="text-sm text-zinc-400 mb-1">الإجابة الصحيحة</p>
              <p className="text-2xl font-bold text-brand-gold">{questionData?.a}</p>
            </div>
            <div className="text-left">
              <p className="text-sm text-zinc-400 mb-1">الإجابات الصحيحة</p>
              <p className="text-2xl font-bold text-white">{correctPlayers.length} / {activePlayers.length}</p>
            </div>
            {fastestPlayer && (
              <div className="text-left">
                <p className="text-sm text-zinc-400 mb-1">الأسرع</p>
                <p className="text-xl font-bold text-brand-gold flex items-center gap-2">
                  <Clock className="w-4 h-4" /> {fastestPlayer.username} ({(settings.timePerQuestion - (fastestPlayer.answerTime || 0))} ثانية)
                </p>
              </div>
            )}
          </div>

          <div className="w-full bg-zinc-900 border border-zinc-800 rounded-2xl overflow-hidden flex-1 min-h-0 flex flex-col mb-6">
            <div className="grid grid-cols-4 gap-4 p-4 bg-zinc-800/50 border-b border-zinc-800 text-sm font-medium text-zinc-400">
              <div>اللاعب</div>
              <div>الإجابة</div>
              <div>الوقت</div>
              <div className="text-left">النقاط</div>
            </div>
            <div className="overflow-y-auto flex-1 p-2 space-y-1">
              {activePlayers.map((p, i) => {
                const isCorrect = checkAnswer(p.currentAnswer);
                const hasAnswered = !!p.currentAnswer;
                
                return (
                  <div key={p.username} className={`grid grid-cols-4 gap-4 p-3 rounded-lg items-center ${isCorrect ? 'bg-brand-gold/10 border border-brand-gold/20' : hasAnswered ? 'bg-white/5 border border-white/10' : 'bg-black/20 border border-white/5'}`}>
                    <div className="flex items-center gap-2">
                      <span className="text-zinc-500 text-xs">#{i + 1}</span>
                      <span className="text-zinc-200 font-medium truncate">{p.username}</span>
                    </div>
                    <div className="truncate">
                      {hasAnswered ? (
                        <span className={isCorrect ? 'text-emerald-400' : 'text-red-400'}>
                          {isCorrect ? <CheckCircle2 className="w-4 h-4 inline mr-1" /> : <XCircle className="w-4 h-4 inline mr-1" />}
                          {p.currentAnswer}
                        </span>
                      ) : (
                        <span className="text-zinc-500 italic">تخطى</span>
                      )}
                    </div>
                    <div className="text-zinc-400 text-sm">
                      {hasAnswered ? `${settings.timePerQuestion - (p.answerTime || 0)} ثانية` : '-'}
                    </div>
                    <div className={`text-left font-bold ${p.roundPoints && p.roundPoints > 0 ? 'text-emerald-400' : 'text-zinc-500'}`}>
                      +{p.roundPoints || 0}
                    </div>
                  </div>
                );
              })}
            </div>
          </div>

          <button 
            onClick={startNextQuestion}
            className="bg-brand-gold hover:bg-brand-gold-light text-black font-bold py-4 px-12 rounded-xl transition-colors flex items-center justify-center gap-2 text-lg w-full max-w-md shadow-[0_0_20px_rgba(212,175,55,0.2)]"
          >
            {currentQuestion >= settings.numQuestions ? 'إنهاء اللعبة' : 'السؤال التالي'} <ArrowRight className="w-5 h-5 rotate-180" />
          </button>
        </div>
      );
    }

    if (phase === 'final_results') {
      return (
        <div className="flex flex-col items-center justify-center h-full w-full max-w-4xl mx-auto font-arabic" dir="rtl">
          <Trophy className="w-20 h-20 text-brand-gold mb-6" />
          <h2 className="text-5xl font-black text-white mb-2 tracking-tight">لوحة الصدارة النهائية</h2>
          <p className="text-xl text-zinc-400 mb-12">انتهت اللعبة! إليكم النتائج النهائية.</p>
          
          <div className="w-full max-w-2xl space-y-3 mb-12">
            {sortedPlayers.map((p, i) => (
              <motion.div 
                initial={{ opacity: 0, x: 20 }}
                animate={{ opacity: 1, x: 0 }}
                transition={{ delay: i * 0.1 }}
                key={p.username} 
                className={`flex items-center justify-between p-4 rounded-xl border ${
                  i === 0 ? 'bg-brand-gold/20 border-brand-gold/50' :
                  i === 1 ? 'bg-zinc-300/20 border-zinc-300/50' :
                  i === 2 ? 'bg-amber-600/20 border-amber-600/50' :
                  'bg-black/40 border-brand-gold/10'
                }`}
              >
                <div className="flex items-center gap-4">
                  <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold ${
                    i === 0 ? 'bg-brand-gold text-black' :
                    i === 1 ? 'bg-zinc-300 text-zinc-900' :
                    i === 2 ? 'bg-amber-600 text-amber-950' :
                    'bg-black text-brand-gold/50 border border-brand-gold/20'
                  }`}>
                    {i + 1}
                  </div>
                  <span className={`text-xl font-bold ${
                    i === 0 ? 'text-brand-gold' :
                    i === 1 ? 'text-zinc-300' :
                    i === 2 ? 'text-amber-500' :
                    'text-zinc-200'
                  }`}>{p.username}</span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="text-2xl font-black font-mono text-white">{p.score}</span>
                  <span className="text-sm text-zinc-400 uppercase tracking-wider">نقطة</span>
                </div>
              </motion.div>
            ))}
          </div>

          <div className="flex gap-4">
            <button 
              onClick={() => setPhase('config')}
              className="bg-black/40 hover:bg-black/60 text-white font-bold py-3 px-8 rounded-xl transition-colors border border-brand-gold/20 hover:border-brand-gold/40"
            >
              اللعب مرة أخرى
            </button>
            <button 
              onClick={onLeave}
              className="bg-brand-gold hover:bg-brand-gold-light text-black font-bold py-3 px-8 rounded-xl transition-colors shadow-[0_0_20px_rgba(212,175,55,0.2)]"
            >
              العودة للألعاب
            </button>
          </div>
        </div>
      );
    }

    return null;
  };

  return (
    <div className="flex gap-8 h-[85vh] w-full max-w-[1600px] mx-auto">
      {/* Main Trivia Area */}
      <div className="flex-1 bg-black/60 backdrop-blur-xl rounded-[40px] border border-brand-gold/20 p-8 flex flex-col relative overflow-hidden shadow-[0_0_50px_rgba(0,0,0,0.5)] font-arabic" dir="rtl">
        <div className="absolute inset-0 bg-gradient-to-br from-brand-gold/5 to-transparent" />
        <button 
          onClick={onLeave} 
          className="absolute top-6 right-6 text-brand-gold/70 hover:text-brand-gold flex items-center gap-2 transition-colors z-50 bg-brand-gold/5 px-4 py-2 rounded-xl border border-brand-gold/20 hover:border-brand-gold/40"
        >
          <ArrowRight className="w-5 h-5" /> العودة للردهة
        </button>
        
        <div className="h-full w-full pt-12 flex flex-col relative z-10">
          {renderPhase()}
        </div>
      </div>

        {/* Twitch Chat Sidebar */}
      <div className="w-[500px] flex flex-col gap-4">
          <div className="flex-1 min-h-0 bg-black/60 backdrop-blur-xl rounded-[40px] border border-brand-gold/20 overflow-hidden shadow-2xl">
          <TwitchChat 
            channelName={channelName} 
            messages={messages} 
            isConnected={isConnected} 
            error={error} 
          />
        </div>
      </div>
    </div>
  );
};
